

<!doctype html>
<html lang="fr">
    <head>
        <title>Mise en place d'un serveur web</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="../assets/normalize.css/normalize.css">
        <link rel="stylesheet" href="../assets/fontawesome/css/all.min.css">
        <link rel="stylesheet" href="../assets/katex/katex.min.css">
        <link rel="stylesheet" href="../styles/page.css">
    </head>
    <body>
        <header>
            
    <nav>
    
        <a href="soc-projet-sw.html">&larr;&nbsp;Développement d'un pilote de contrôleur SPI</a>
    
    
        <a href="soc-projet-pmod-acl.html">Accéléromètre sur bus SPI&nbsp;&rarr;</a>
    
</nav>

    
                <h1>Mise en place d'un serveur web</h1>
                
                
            

        </header>
        
    
        <ul class="toc">
            
            
                
                <li><a href="#serveur-http">Serveur HTTP</a></li>
            
                
                    <li><ul>
                    
                
                <li><a href="#installer-le-serveur">Installer le serveur</a></li>
            
                
                <li><a href="#creer-un-script-execute-par-le-serveur-web">Créer un script exécuté par le serveur web</a></li>
            
                
                    </ul></li>
                    
                
                <li><a href="#interroger-le-capteur-a-travers-le-web">Interroger le capteur à travers le web</a></li>
            
            
        </ul>
            
    
    <section><h1 id="serveur-http" tabindex="-1">Serveur HTTP</h1>
</section><section><h2 id="installer-le-serveur" tabindex="-1">Installer le serveur</h2>
<p>Le serveur web <em>busybox httpd</em> est fourni avec PetaLinux.</p>
<ol>
<li>Configurez votre image Linux de la manière suivante&nbsp;:</li>
</ol>
<pre><code class="icon-term language-bash">petalinux-config -c rootfs
</code></pre>
<ol start="2">
<li>Sélectionnez <em>Filesystem Packages</em> → <em>base</em> → <em>busybox</em> et cochez la case <em>busybox-httpd</em>.</li>
<li>Sélectionnez <em>Filesystem Packages</em> → <em>base/shell</em> → <em>bash</em> et cochez la case <em>bash</em>.</li>
<li>Sélectionnez <em>Filesystem Packages</em> → <em>console/network</em> → <em>dropbear</em> et cochez la case <em>dropbear</em>.</li>
</ol>
<p>Le serveur HTTP servira les fichiers présents dans le dossier <code>/srv/www</code>.
Le sous-dossier <code>/srv/www/cgi-bin</code> contiendra des scripts que le serveur HTTP exécutera à chaque fois qu’on cherchera à y accéder.</p>
</section><section><h2 id="creer-un-script-execute-par-le-serveur-web" tabindex="-1">Créer un script exécuté par le serveur web</h2>
<ol>
<li>Créez une application PetaLinux précompilée</li>
</ol>
<pre><code class="icon-term language-bash">petalinux-create --<span class="hljs-built_in">type</span> apps --template install --name zybo-acl-app --<span class="hljs-built_in">enable</span>
</code></pre>
<ol start="2">
<li>Modifiez le fichier <code>components/apps/zybo-acl-app/Makefile</code> afin que la cible
<code>install</code> soit&nbsp;:</li>
</ol>
<pre><code class="icon-file language-makefile"><span class="hljs-section">install:</span>
    <span class="hljs-variable">$(TARGETINST)</span> -d -p 755 data/zybo-acl-app /srv/www/cgi-bin/zybo-acl-app
</code></pre>
<ol start="3">
<li>Modifiez le fichier <code>components/apps/zybo-acl-app/data/zybo-acl-app</code>&nbsp;:</li>
</ol>
<pre><code class="icon-file language-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'Content-type: text/html'</span>
<span class="hljs-built_in">echo</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'&lt;h1&gt;Hello&lt;/h1&gt;'</span>
</code></pre>
<ol start="4">
<li>Reconstruisez, empaquetez et redémarrez votre image Linux&nbsp;:</li>
</ol>
<pre><code class="icon-term language-bash">petalinux-build
petalinux-package --force --prebuilt --fpga ../zybo-first-project-vivado/zybo-first-project-vivado.runs/impl_1/zybo_first_design_wrapper.bit
petalinux-boot --jtag --prebuilt 3
</code></pre>
<p>Si votre carte a l’adresse IP 192.168.5.12, alors l’accès à l’adresse
<code>http://192.168.5.12/cgi-bin/zybo-acl-app</code> retournera une page avec un titre de premier niveau «&nbsp;Hello&nbsp;».</p>
</section><section><h1 id="interroger-le-capteur-a-travers-le-web" tabindex="-1">Interroger le capteur à travers le web</h1>
<p>En vous inspirant du squelette ci-desous, modifiez le script <code>zybo-acl-app</code>
afin d’afficher l’état de l’accéléromètre dans une page web.</p>
<pre><code class="icon-file language-bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># Vérifier si le pilote du contrôleur SPI a déjà été chargé.</span>
<span class="hljs-keyword">if</span> [ ! -e /sys/class/eseo/zybo-spi-device ]; <span class="hljs-keyword">then</span>
    <span class="hljs-comment"># Charger le pilote du contrôleur SPI.</span>
    modprobe zybo-spi-module

    <span class="hljs-comment"># Configurer le contrôleur SPI.</span>
    <span class="hljs-comment"># À compléter...</span>

    <span class="hljs-comment"># Initialiser l'accéléromètre.</span>
    <span class="hljs-comment"># À compléter...</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># Lire la valeur courante de l'accélération en X, Y et Z</span>
<span class="hljs-comment"># À compléter...</span>

<span class="hljs-comment"># Générer la page web avec rechargement automatique toutes les 2 secondes.</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'Content-type: text/html'</span>
<span class="hljs-built_in">echo</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'&lt;meta http-equiv="refresh" content="2"&gt;'</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'&lt;h1&gt;Acceleration&lt;/h1&gt;'</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"&lt;p&gt;<span class="hljs-variable">$X</span> <span class="hljs-variable">$Y</span> <span class="hljs-variable">$Z</span>&lt;/p&gt;"</span>
</code></pre>
<p>Pour vous aider à configurer l’accéléromètre et à lire l’accélération,
une documentation minimale de <a href="soc-projet-pmod-acl.html">l’accéléromètre ADXL345</a>
est disponible.</p>
</section>
    
        
    

    
    <footer>
        <nav>
    
        <a href="soc-projet-sw.html">&larr;&nbsp;Développement d'un pilote de contrôleur SPI</a>
    
    
        <a href="soc-projet-pmod-acl.html">Accéléromètre sur bus SPI&nbsp;&rarr;</a>
    
</nav>

    </footer>

        <div class="sidebar-show"><i class="fas fa-bars"></i></div>
        <div class="sidebar">
            <div class="sidebar-top">
                <div class="sidebar-hide"><i class="fas fa-times-circle"></i></div>
                <form class="search" action="../search.html" method="get">
                    <input name="q" type="search" placeholder="Rechercher">
                    <button type="submit"><i class="fas fa-search"></i></button>
                </form>
                <a href="../index.html"><i class="fas fa-home"></i>&nbsp;Accueil</a>
            </div>
            
    
        <ul class="toc">
            
                <li>
                    <a href="../termes.html" >Index des termes et des mots-clés du langage VHDL</a>
                    
    

                </li>
            
                <li>
                    <a href="../numerique/index.html" >Représentation des informations</a>
                    
    
        <ul>
            
                <li>
                    <a href="../numerique/analogique-vs-numerique.html" >Analogique vs numérique</a>
                    
    

                </li>
            
                <li>
                    <a href="../numerique/numeration-binaire.html" >Numération binaire</a>
                    
    

                </li>
            
                <li>
                    <a href="../numerique/numeration-hexadecimale.html" >Numération hexadécimale</a>
                    
    

                </li>
            
                <li>
                    <a href="../numerique/arithmetique-binaire.html" >Arithmétique binaire</a>
                    
    

                </li>
            
                <li>
                    <a href="../numerique/complement-a-deux.html" >Représentation des nombres négatifs</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/index.html" >Circuits logiques</a>
                    
    
        <ul>
            
                <li>
                    <a href="../circuits-logiques/combinatoire.html" >Circuits logiques combinatoires</a>
                    
    
        <ul>
            
                <li>
                    <a href="../circuits-logiques/combinatoire-fonctions-logiques.html" >Fonctions logiques</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/combinatoire-premiers-circuits-logiques.html" >Nos premiers circuits logiques</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/combinatoire-synthese-logique.html" >Synthèse des fonctions logiques</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/combinatoire-decodeurs-mux-demux.html" >Circuits logiques composés</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/sequentiel.html" >Circuits logiques séquentiels</a>
                    
    
        <ul>
            
                <li>
                    <a href="../circuits-logiques/sequentiel-vs-combinatoire.html" >Combinatoire vs séquentiel</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/sequentiel-element-de-memorisation.html" >Construisons un élément de mémorisation</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/sequentiel-registres-et-compteurs.html" >Registres et compteurs</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/sequentiel-conception-synchrone.html" >Conception de circuits synchrones</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/sequentiel-activite.html" >Activité : circuits logiques séquentiels</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/automates.html" >Automates finis</a>
                    
    
        <ul>
            
                <li>
                    <a href="../circuits-logiques/automates-modelisation.html" >Modélisation par graphe d'états</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/automates-mathematiques.html" >Définition mathématique des automates finis</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/automates-synthese.html" >Synthèse des automates finis</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/automates-activite.html" >Activité : automates</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/circuits-programmables.html" >Circuits logiques programmables</a>
                    
    
        <ul>
            
                <li>
                    <a href="../circuits-logiques/circuits-programmables-notion.html" >Notion de circuit logique programmable</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/circuits-programmables-simples.html" >Circuits programmables simples (SPLD) et complexes (CPLD)</a>
                    
    

                </li>
            
                <li>
                    <a href="../circuits-logiques/circuits-programmables-fpga.html" >FPGA</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/index.html" >Découverte du langage VHDL</a>
                    
    
        <ul>
            
                <li>
                    <a href="../langage-vhdl/hdl.html" >Qu'est-ce qu'un langage de description de matériel ?</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/structure.html" >Décrire et interconnecter des composants</a>
                    
    
        <ul>
            
                <li>
                    <a href="../langage-vhdl/structure-entites.html" >Entités</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/structure-architectures.html" >Architectures</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/structure-entites-architectures-activite.html" >Activité : entités et architectures</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/structure-instanciation.html" >Instanciation d'une entité</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/structure-instanciation-activite.html" >Activité : instanciation d'une entité</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/combinatoire.html" >Décrire des circuits combinatoires</a>
                    
    
        <ul>
            
                <li>
                    <a href="../langage-vhdl/combinatoire-affectations-concurrentes.html" >Affectations concurrentes de signaux</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/combinatoire-affectations-concurrentes-activite.html" >Activité : affectations concurrentes de signaux</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/combinatoire-processus.html" >Processus</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/combinatoire-processus-activite.html" >Activité : processus</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/sequentiel.html" >Décrire des circuits séquentiels</a>
                    
    
        <ul>
            
                <li>
                    <a href="../langage-vhdl/sequentiel-bascules-et-registres.html" >Bascules et registres</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/sequentiel-compteurs-et-diviseurs-de-frequence.html" >Compteurs et diviseurs de fréquence</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/sequentiel-automates.html" >Automates</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/sequentiel-activite.html" >Activité : circuits séquentiels</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercices.html" >Exercices</a>
                    
    
        <ul>
            
                <li>
                    <a href="../langage-vhdl/exercice-bargraph.html" >Exercice : bargraph</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-blinker.html" >Exercice : faire clignoter une LED</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-dimmer.html" >Exercice : variateur d'intensité lumineuse</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-timepressed.html" >Exercice : mesure de temps d'appui</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-light-sequencer.html" >Exercice : séquenceur lumineux</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-chaser.html" >Exercice : attrape-moi</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-metronome.html" >Exercice : métronome</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-vhdl/exercice-pingpong.html" >Exercice : ping-pong</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../ordinateur/index.html" >Pratique du VHDL : je développe mon propre ordinateur</a>
                    
    
        <ul>
            
                <li>
                    <a href="../ordinateur/virgule-simple-io-activite.html" >Activité : mon premier système embarqué</a>
                    
    

                </li>
            
                <li>
                    <a href="../ordinateur/virgule-uart-activite.html" >Activité : ajout d'une interface série</a>
                    
    

                </li>
            
                <li>
                    <a href="../ordinateur/virgule-interruptions-activite.html" >Activité : gestion d'interruptions</a>
                    
    

                </li>
            
                <li>
                    <a href="../ordinateur/virgule-spi-activite.html" >Activité : intégration d'un contrôleur de bus SPI</a>
                    
    

                </li>
            
                <li>
                    <a href="../ordinateur/virgule-i2c-activite.html" >Activité : intégration d'un contrôleur de bus I<sup>2</sup>C</a>
                    
    

                </li>
            
                <li>
                    <a href="../ordinateur/virgule-sonar-activite.html" >Activité : intégration d'un récepteur série pour sonar</a>
                    
    

                </li>
            
                <li>
                    <a href="../ordinateur/virgule-logiciel-activite.html" >Activité : développement logiciel embarqué</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/index.html" >L'essentiel de VHDL</a>
                    
    
        <ul>
            
                <li>
                    <a href="../essentiel-vhdl/unites-de-conception.html" >Unités de conception</a>
                    
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/instructions-concurrentes.html" >Instructions concurrentes</a>
                    
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/instructions-sequentielles.html" >Instructions séquentielles</a>
                    
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/types.html" >Types prédéfinis</a>
                    
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/declarations.html" >Déclarations</a>
                    
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/expressions.html" >Expressions</a>
                    
    

                </li>
            
                <li>
                    <a href="../essentiel-vhdl/simulation.html" >VHDL pour la simulation</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/index.html" >VHDL avancé : traitement de signaux audio sur FPGA</a>
                    
    
        <ul>
            
                <li>
                    <a href="../vhdl-audio/application.html" >Présentation de l'application</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/preparation.html" >Préparation de l'environnement de travail</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/i2s.html" >Sortie audio I<sup>2</sup>S</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/producteur-consommateur.html" >Connecter producteurs et consommateurs : le protocole ready/valid</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/virgule-fixe.html" >Arithmétique en virgule fixe</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/vocoder-pkg.html" >Le paquetage Vocoder_pkg</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/oscillateur.html" >Oscillateur</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/filtre.html" >Filtre</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/modulateur-melangeur.html" >Modulateur et mélangeur</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/vocodeur.html" >Vocodeur</a>
                    
    

                </li>
            
                <li>
                    <a href="../vhdl-audio/microphone.html" >Entrée audio</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../langage-verilog/index.html" >Découverte du langage Verilog</a>
                    
    
        <ul>
            
                <li>
                    <a href="../langage-verilog/structure.html" >Décrire et interconnecter des composants</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-verilog/declarations.html" >Déclarations et types de données</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-verilog/combinatoire.html" >Décrire des circuits combinatoires</a>
                    
    

                </li>
            
                <li>
                    <a href="../langage-verilog/sequentiel.html" >Décrire des circuits séquentiels</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../verilog-squash/index.html" >Pratique du Verilog : développement d'un jeu vidéo</a>
                    
    
        <ul>
            
                <li>
                    <a href="../verilog-squash/specifications.html" >Présentation de l'application</a>
                    
    

                </li>
            
                <li>
                    <a href="../verilog-squash/preparation.html" >Préparation de l'environnement de travail</a>
                    
    

                </li>
            
                <li>
                    <a href="../verilog-squash/structure-generale.html" >Structure générale</a>
                    
    

                </li>
            
                <li>
                    <a href="../verilog-squash/afficher.html" >Gestion de l'affichage</a>
                    
    

                </li>
            
                <li>
                    <a href="../verilog-squash/animer.html" >Animer la balle et la raquette</a>
                    
    

                </li>
            
                <li>
                    <a href="../verilog-squash/deroulement.html" >Gérer le déroulement du jeu</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="index.html" >Introduction au développement d'un System-on-Chip sur circuit programmable</a>
                    
    
        <ul>
            
                <li>
                    <a href="soc-tutorial.html" >Prise en main de l'environnement de développement</a>
                    
    
        <ul>
            
                <li>
                    <a href="soc-tutorial-hw.html" >Configuration de la plate-forme matérielle</a>
                    
    

                </li>
            
                <li>
                    <a href="soc-tutorial-os.html" >Configuration du système d'exploitation</a>
                    
    

                </li>
            
                <li>
                    <a href="soc-tutorial-sw.html" >Développement logiciel</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="soc-projet.html" >Projet : développement d'un capteur connecté</a>
                    
    
        <ul>
            
                <li>
                    <a href="soc-projet-hw.html" >Création d'un nouveau composant IP</a>
                    
    

                </li>
            
                <li>
                    <a href="soc-projet-spi.html" >Développement d'un contrôleur de bus SPI</a>
                    
    

                </li>
            
                <li>
                    <a href="soc-projet-sw.html" >Développement d'un pilote de contrôleur SPI</a>
                    
    

                </li>
            
                <li>
                    <a href="soc-projet-web.html" class="current">Mise en place d'un serveur web</a>
                    
    

                </li>
            
                <li>
                    <a href="soc-projet-pmod-acl.html" >Accéléromètre sur bus SPI</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="soc-installation.html" >Installation et configuration des outils de développement</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
                <li>
                    <a href="../annexes/index.html" >Annexes</a>
                    
    
        <ul>
            
                <li>
                    <a href="../annexes/virgule.html" >Virgule : un cœur RISC-V minimal</a>
                    
    

                </li>
            
                <li>
                    <a href="../annexes/installation-xilinx-vivado.html" >Installer Xilinx Vivado</a>
                    
    

                </li>
            
                <li>
                    <a href="../annexes/installation-ghdl-cocotb.html" >Travailler avec des logiciels libres</a>
                    
    

                </li>
            
        </ul>
    

                </li>
            
        </ul>
    

        </div>
        <script type="text/javascript">
            document.querySelector(".sidebar-show").addEventListener("click", () => {
                const sidebar    = document.querySelector(".sidebar");
                const sidebarTop = sidebar.querySelector(".sidebar-top");
                const sidebarToc = sidebar.querySelector(".toc");
                const current    = sidebar.querySelector(".current");
                sidebar.classList.add("sidebar-visible");
                sidebarToc.style.paddingTop = getComputedStyle(sidebarTop).height;
                if (current) {
                    current.scrollIntoView({block: "center"});
                }
            });

            document.querySelector(".sidebar-hide").addEventListener("click", () => {
                document.querySelector(".sidebar").classList.remove("sidebar-visible");
            });
        </script>
    </body>
</html>
